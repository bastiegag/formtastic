!function(t){t(".ft-export").on("click",(function(){var e=t(this),a=t("#export_form").val(),i=t("#export_from_date").val(),r=t("#export_to_date").val();return e.is(".ft-loading")||(e.addClass("ft-loading").prop("disabled",!0),t.ajax({type:"POST",dataType:"json",url:ft.ajax_url,data:{action:"ft_export_responses",form_id:a,min:i,max:r},success:function(t){var a=t.data.url;window.location.href=a,e.removeClass("ft-loading").prop("disabled",!1)}})),!1}))}(jQuery),function(t){t(".ft-import").on("click",(function(){var e=t(this),a=t("#ft-import-form")[0].files[0];if(!e.is(".ft-loading")){e.addClass("ft-loading").prop("disabled",!0);var i=new FormData;i.append("action","ft_import_form"),i.append("form_id",e.attr("data-form")),i.append("file",a),t.ajax({type:"POST",url:ft.ajax_url,data:i,processData:!1,contentType:!1,success:function(t){console.log(t),window.location.reload(!0),e.removeClass("ft-loading").prop("disabled",!1)}})}return!1}))}(jQuery),function(t){t(".ft-resend").on("click",(function(){var e=t(this),a=e.attr("data-form"),i=e.attr("data-id");return e.is(".is-process")||(e.addClass("is-process").closest("tr").addClass("ft-sending"),t.ajax({type:"POST",dataType:"json",url:ft.ajax_url,data:{action:"ft_resend",form_id:a,response_id:i},success:function(t){e.removeClass("is-process").closest("tr").removeClass("ft-sending").addClass("ft-sended"),setTimeout((function(){e.closest("tr").removeClass("ft-sended")}),1500)}})),!1}))}(jQuery),function(t){function e(e){this.each((function(){var e=t(this);e.find(".ft-tabs-nav a").each((function(){var a=t(this);if(a.is(".active")){var i=a.attr("href");e.find(i).addClass("active")}})).on("click",(function(){var a=t(this),i=a.attr("href"),r=e.find(".ft-tabs-nav");return a.is(".active")||(r.find(".active").removeClass("active"),a.addClass("active"),e.find(".ft-tab-content.active").removeClass("active").end().find(i).addClass("active")),!1}))}))}jQuery.fn.formtasticTabs=function(){if("string"==typeof arguments[0]){var t=Array.prototype.slice.call(arguments);t.splice(0,1),methods[arguments[0]].apply(this,t)}else e.apply(this,arguments);return this}}(jQuery),function(t){t(".ft-unread").on("click",(function(){var e=t(this),a=e.attr("data-id");return e.is(".is-process")||(e.addClass("is-process"),t.ajax({type:"POST",dataType:"json",url:ft.ajax_url,data:{action:"ft_read",response_id:a},success:function(t){var a=e.find("svg").attr("data-path");e.removeClass("ft-unread").addClass("ft-read"),e.find("svg use").attr("xlink:href",a+"#mail-open")}})),!1}))}(jQuery),function(t){"use strict";t(window).on("load",(function(){!function(){var e;function a(t){try{JSON.parse(t)}catch(t){return!1}return!0}var i="dd-mm-yy",r=t("#export_from_date").datepicker({dateFormat:"d-m-yy",maxDate:0}).on("change",(function(){n.datepicker("option","minDate",f(this))})),n=t("#export_to_date").datepicker({dateFormat:"d-m-yy",maxDate:0}).on("change",(function(){r.datepicker("option","maxDate",f(this))}));function f(e){var a;try{a=t.datepicker.parseDate(i,e.value)}catch(t){a=null}return a}function s(e){if(a(e.find("> .ft-data").val())){for(var i=JSON.parse(e.find("> .ft-data").val()),r="",n=0;n<i.length;n++)if("fields"==i[n].name){i.splice(n,1);break}var f=0;e.find(".ft-sortable .ft-data").each((function(){var e=t(this).attr("id");r+=0===f?e:","+e,f++})),""!==r&&i.push({name:"fields",value:r}),e.find("> .ft-data").val(JSON.stringify(i))}}function l(){var e=t("#ft-edit-field-form :input"),a=t("#ft-edit-field-form .ft-values-field");e.each((function(){switch(t(this).attr("type")){case"text":case"number":case void 0:t(this).val("");break;case"checkbox":t(this).prop("checked",!1)}})),a.each((function(){t(this).is(".ft-main")||t(this).remove()}))}t(".ft-tabs").formtasticTabs(),t(".ft-sortable").disableSelection(),t(".ft-sortable").sortable({placeholder:"ft-placeholder",forcePlaceholderSize:!0,connectWith:".ft-sortable",tolerance:"pointer",start:function(t,e){if(!e.helper.is(".ft-create-field")){var a=e.helper.width(),i=e.helper.height();e.placeholder.width(a),e.placeholder.height(i-1)}}}),t(".ft-sortable-values").disableSelection(),t(".ft-sortable-values").sortable({placeholder:"ft-placeholder",forcePlaceholderSize:!0}),t(".ft-sortable").on("sortreceive",(function(e,a){if(null!==a.helper&&a.item.is(".ft-create-field")){var i=a.helper.attr("data-field");a.helper.css("opacity","0"),t(e.target).is(".ft-sortable-fieldset")&&"fieldset"==t(a.item).attr("data-field")?a.helper.remove():t.ajax({type:"POST",dataType:"json",url:ft.ajax_url,data:{action:"ft_create_field",field_type:i},success:function(e){t(e.data.html).insertBefore(a.helper),t("#"+e.data.id).closest(".ft-field").find(".ft-edit").trigger("click"),"fieldset"==i&&t("#"+e.data.id).closest(".ft-field").find(".ft-sortable").sortable({placeholder:"ft-placeholder",forcePlaceholderSize:!0,connectWith:".ft-sortable"}),a.helper.remove()}})}})),t(document).on("sortreceive, sortupdate",".ft-field-fieldset .ft-sortable",(function(e,a){var i=t(this).closest(".ft-field-fieldset");t(e.target).is(".ft-sortable-fieldset")&&t(a.item).is(".ft-field-fieldset")?a.sender.sortable("cancel"):s(i)})),t(".ft-create-field").draggable({connectToSortable:".ft-sortable",helper:"clone",appendTo:"body"}),t(document).on("click",'.ft-values[name="selection"]',(function(){var e=t(this);e.prop("checked");"true"==e.attr("data-prev")?(e.prop("checked",!1),t("#ft-manual").find('input[type="radio"]').attr("data-prev","false")):(t("#ft-manual").find('input[type="radio"]').attr("data-prev","false"),e.attr("data-prev","true"))})),t(document).on("click",".ft-trash",(function(){var e=t(this).closest(".ft-field"),a=e.closest(".ft-sortable");return e.fadeOut(300,(function(){(e.remove(),a.is(".ft-sortable-fieldset"))&&s(a.closest(".ft-field-fieldset"))})),!1})),t(document).on("click",".ft-edit",(function(){l();var i,r,n=t(this).closest(".ft-field"),f=n.attr("data-controls"),s=t("#ft-edit-field-form"),o=n.find(".ft-label").text();t("#ft-edit-field-form").find(".ft-field").hide().removeClass("ft-active"),f=f.split(",");for(var d=0;d<f.length;d++)t("#ft-"+f[d]+"-field").show().addClass("ft-active");if(a((e=n).find(".ft-data").val())){var c=[],u=[],p="",v=t("#ft-manual");r=JSON.parse(e.find(".ft-data").val());for(var h=0,m=0,b=0;b<r.length;b++)if("values"==r[b].name)c[h]=r[b].value,h++;else if("conditions"==r[b].name)u[m]=r[b].value,m++;else if("selection"==r[b].name)p=r[b].value;else{var y=s.find(":input[name="+r[b].name+"]");if(y.is("select"))y.val(r[b].value);else if(y.is("textarea"))y.val(r[b].value);else switch(y.attr("type")){case"checkbox":y.prop("checked",!0);break;case"text":case"number":case"hidden":y.val(r[b].value)}}c&&t.ajax({type:"POST",dataType:"json",url:ft.ajax_url,data:{action:"ft_create_value",values:c,conditions:u,selection:p},success:function(t){var e=t.data.html;v.append(e)}}),t(".ft-values-type").change()}return i="fr"==ft.lang_code?"Modifier":"Edit",tb_show(i+" &lt;"+o+"&gt;","#TB_inline?width=600&height=550&inlineId=ft-edit-field",null),t("#ft-label").focus().select(),!1})),t(document).on("change",".ft-values-type",(function(){var e=t(this).val();t("#ft-values-field").find(".ft-values-tab").hide(),t("#"+e).show()})),t(document).on("change",'.ft-values-field input[name="values"]',(function(){var e=t(this);e.closest(".ft-values-field").find('input[name="selection"]').val(e.val())})),t(document).on("click",".ft-copy",(function(){var i,r=t(this).closest(".ft-field");if(a((e=r).find(".ft-data").val())){i=e.find(".ft-data").val();var n=JSON.parse(i)[0].value;t.ajax({type:"POST",dataType:"json",url:ft.ajax_url,data:{action:"ft_create_field",field_data:i,field_type:n},success:function(a){(t(a.data.html).insertBefore(r),e.closest(".ft-sortable").is(".ft-sortable-fieldset"))&&s(e.closest(".ft-field-fieldset"))}})}return!1})),t(document).on("click",".ft-add-value",(function(){t.ajax({type:"POST",dataType:"json",url:ft.ajax_url,data:{action:"ft_create_value"},success:function(e){t("#ft-manual").append(e.data.html)}})})),t(document).on("click",".ft-substract-value",(function(){t(this).closest(".ft-values-field").fadeOut(300,(function(){t(this).remove()}))})),t("#ft-save").on("click",(function(){var a=t("#ft-edit-field-form"),i=a.find("#ft-label").val(),r=a.find("#ft-btn-label").val(),n=a.find("#ft-text").val(),f=a.find("#ft-placeholder").val(),o=a.find("#ft-message").val().replace(/\n/g,"<br \\>"),d=a.find("#ft-value").val(),c=a.find("#ft-valuenum").val(),u=a.find("#ft-colsize").val(),p=a.find("#ft-required"),v=a.find("#ft-repeat"),h=JSON.stringify(t("#ft-edit-field-form .ft-active :input").filter((function(){return this.value||"conditions"==t(this).attr("name")||"selection"==t(this).attr("name")&&t(this).prop("checked")})).serializeArray()),m=t("#ft-edit-field-form .ft-values").filter((function(){return this.value})).serializeArray();e.removeClass((function(t,e){return(e.match(/(^|\s)ft-col-\S+/g)||[]).join(" ")})).addClass("ft-col-"+u);var b=e.find(".ft-display"),y=e.attr("data-type");if(e.find("> label .ft-label").text(i),""===r?e.find("button").text(e.find("button").attr("data-label")):e.find("button").text(r),e.find(".ft-text").text(n),p.prop("checked")?e.addClass("required").find("> label .ft-required").text("*"):e.removeClass("required").find("> label .ft-required").text(""),v.prop("checked")?e.find(".ft-repeat").show():e.find(".ft-repeat").hide(),b.is("select")?b.find("option").text(f):b.is("div")?b.html(o):""!==c?b.attr("placeholder",f).val(c):b.attr("placeholder",f).val(d),"checkbox"==y||"radio"==y){e.find(".ft-choice").empty();for(var _=0;_<m.length;_++)if("values"==m[_].name){var x=m[_].value.split(":"),g="";g=void 0!==x[1]?x[1]:x[0],e.find(".ft-choice").append('<label><input type="'+y+'" class="ft-display" value="">'+g+"</label>")}}(h=h.replace(/\\r\\n/g,"<br />"),e.find("> .ft-data").val(h),tb_remove(),e.closest(".ft-sortable").is(".ft-sortable-fieldset"))&&s(e.closest(".ft-field-fieldset"));return l(),!1})),t("#ft-cancel").on("click",(function(){return tb_remove(),!1})),t(document).on("click",".ft-autoselect",(function(){t(this).select()})),t("#custom_color").wpColorPicker(),t(".ft-select-tab").on("change",(function(){var e=t(this).val();t(this).closest(".ft-tab-content").find("[data-tab]").addClass("ft-hidden").end().find("[data-tab="+e+"]").removeClass("ft-hidden")})),t(".ft-upload-media").on("click",(function(){var e=wp.media.editor.send.attachment,a=t(this);return wp.media.editor.send.attachment=function(i,r){t(a).parent().prev().attr("src",r.url),t(a).prev().val(r.id),wp.media.editor.send.attachment=e},wp.media.editor.open(a),!1})),t(".ft-remove-media").on("click",(function(){var e=t(this).parent().prev().attr("data-src");return t(this).parent().prev().attr("src",e),t(this).prev().prev().val(""),!1})),t("#ft_response_form").on("change",(function(){var e=t(this);""==e.val()?t("#ft-export-response").attr("href","#").attr("disabled",!0):t("#ft-export-response").attr("href","admin.php?action=export_responses&form="+e.val()).attr("disabled",!1)}))}()})),t(window).on("load",(function(){""==t("#ft_response_form").val()?t("#ft-export-response").attr("href","#").attr("disabled",!0):t("#ft-export-response").attr("href","admin.php?action=export_responses&form="+t("#ft_response_form").val()).attr("disabled",!1)}))}(jQuery);