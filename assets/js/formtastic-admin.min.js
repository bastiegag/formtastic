!function(t){t(".ft-export").on("click",(function(){var e=t(this),a=t("#export_form").val(),s=t("#export_from_date").val(),i=t("#export_to_date").val();return e.is(".ft-loading")||(e.addClass("ft-loading").prop("disabled",!0),t.ajax({type:"POST",dataType:"json",url:ft.ajax_url,data:{action:"ft_export_responses",form_id:a,min:s,max:i},success:function(t){var a=t.data.url;window.location.href=a,e.removeClass("ft-loading").prop("disabled",!1)}})),!1}))}(jQuery),function(t){t(".ft-import").on("click",(function(){var e=t(this),a=t("#ft-import-form")[0].files[0];if(!e.is(".ft-loading")){e.addClass("ft-loading").prop("disabled",!0);var s=new FormData;s.append("action","ft_import_form"),s.append("form_id",e.attr("data-form")),s.append("file",a),t.ajax({type:"POST",url:ft.ajax_url,data:s,processData:!1,contentType:!1,success:function(t){console.log(t),window.location.reload(!0),e.removeClass("ft-loading").prop("disabled",!1)}})}return!1}))}(jQuery),function(t){t(".ft-resend").on("click",(function(){var e=t(this),a=e.attr("data-form"),s=e.attr("data-id");return e.is(".is-process")||(e.addClass("is-process").closest("tr").addClass("ft-sending"),t.ajax({type:"POST",dataType:"json",url:ft.ajax_url,data:{action:"ft_resend",form_id:a,response_id:s},success:function(t){e.removeClass("is-process").closest("tr").removeClass("ft-sending").addClass("ft-sended"),setTimeout((function(){e.closest("tr").removeClass("ft-sended")}),1500)}})),!1}))}(jQuery),function(t){t(window).on("load",(function(){t(".column-spam").length>0&&t(".column-spam").each((function(){t(this).find("a").is(".ft-unspam")&&t(this).closest("tr").addClass("ft-spammed")}))})),t(document).on("click",".ft-spam",(function(){var e=t(this),a=e.attr("data-response");return e.is(".is-process")||(e.addClass("is-process").closest("tr").addClass("ft-spamming"),t.ajax({type:"POST",dataType:"json",url:ft.ajax_url,data:{action:"ft_spam",response_id:a},success:function(s){var i=e.closest("tr"),n=e.closest("small");e.remove(),t("#ft_response_info_meta_box").length?n.append('<a href="#" class="ft-unspam" data-response="'+a+'">Démarquer comme spam</a>'):i.removeClass("ft-spamming").addClass("ft-spammed").find(".column-spam").append('<a href="#" class="ft-icon ft-unspam" title="Démarquer comme spam" data-response="'+a+'"><svg class="svg-icon" role="presentation"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="'+ft.plugin_dir+'/assets/img/icons.svg#radio"></use></svg></a>')}})),!1})),t(document).on("click",".ft-unspam",(function(){var e=t(this),a=e.attr("data-response");return e.is(".is-process")||(e.addClass("is-process").closest("tr").addClass("ft-spamming"),t.ajax({type:"POST",dataType:"json",url:ft.ajax_url,data:{action:"ft_unspam",response_id:a},success:function(s){var i=e.closest("tr"),n=e.closest("small");e.remove(),t("#ft_response_info_meta_box").length?n.append('<a href="#" class="ft-spam" data-response="'+a+'">Marquer comme spam</a>'):i.removeClass("ft-spammed ft-spamming").find(".column-spam").append('<a href="#" class="ft-icon ft-spam" title="Marquer comme spam" data-response="'+a+'"><svg class="svg-icon" role="presentation"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="'+ft.plugin_dir+'/assets/img/icons.svg#warning"></use></svg></a>')}})),!1}))}(jQuery),function(t){function e(e){this.each((function(){var e=t(this);e.find(".ft-tabs-nav a").each((function(){var a=t(this);if(a.is(".active")){var s=a.attr("href");e.find(s).addClass("active")}})).on("click",(function(){var a=t(this),s=a.attr("href"),i=e.find(".ft-tabs-nav");return a.is(".active")||(i.find(".active").removeClass("active"),a.addClass("active"),e.find(".ft-tab-content.active").removeClass("active").end().find(s).addClass("active")),!1}))}))}jQuery.fn.formtasticTabs=function(){if("string"==typeof arguments[0]){var t=Array.prototype.slice.call(arguments);t.splice(0,1),methods[arguments[0]].apply(this,t)}else e.apply(this,arguments);return this}}(jQuery),function(t){t(".ft-unread").on("click",(function(){var e=t(this),a=e.attr("data-id");return e.is(".is-process")||(e.addClass("is-process"),t.ajax({type:"POST",dataType:"json",url:ft.ajax_url,data:{action:"ft_read",response_id:a},success:function(t){var a=e.find("svg").attr("data-path");e.removeClass("ft-unread").addClass("ft-read"),e.find("svg use").attr("xlink:href",a+"#mail-open")}})),!1}))}(jQuery),function(t){"use strict";t(window).on("load",(function(){!function(){var e;function a(t){try{JSON.parse(t)}catch(t){return!1}return!0}var s="dd-mm-yy",i=t("#export_from_date").datepicker({dateFormat:"d-m-yy",maxDate:0}).on("change",(function(){n.datepicker("option","minDate",r(this))})),n=t("#export_to_date").datepicker({dateFormat:"d-m-yy",maxDate:0}).on("change",(function(){i.datepicker("option","maxDate",r(this))}));function r(e){var a;try{a=t.datepicker.parseDate(s,e.value)}catch(t){a=null}return a}function o(e){if(a(e.find("> .ft-data").val())){for(var s=JSON.parse(e.find("> .ft-data").val()),i="",n=0;n<s.length;n++)if("fields"==s[n].name){s.splice(n,1);break}var r=0;e.find(".ft-sortable .ft-data").each((function(){var e=t(this).attr("id");i+=0===r?e:","+e,r++})),""!==i&&s.push({name:"fields",value:i}),e.find("> .ft-data").val(JSON.stringify(s))}}function l(){var e=t("#ft-edit-field-form :input"),a=t("#ft-edit-field-form .ft-values-field");e.each((function(){switch(t(this).attr("type")){case"text":case"number":case void 0:t(this).val("");break;case"checkbox":t(this).prop("checked",!1)}})),a.each((function(){t(this).is(".ft-main")||t(this).remove()}))}t(".ft-tabs").formtasticTabs(),t(".ft-sortable").disableSelection(),t(".ft-sortable").sortable({placeholder:"ft-placeholder",forcePlaceholderSize:!0,connectWith:".ft-sortable",tolerance:"pointer",start:function(t,e){if(!e.helper.is(".ft-create-field")){var a=e.helper.width(),s=e.helper.height();e.placeholder.width(a),e.placeholder.height(s-1)}}}),t(".ft-sortable-values").disableSelection(),t(".ft-sortable-values").sortable({placeholder:"ft-placeholder",forcePlaceholderSize:!0}),t(".ft-sortable").on("sortreceive",(function(e,a){if(null!==a.helper&&a.item.is(".ft-create-field")){var s=a.helper.attr("data-field");a.helper.css("opacity","0"),t(e.target).is(".ft-sortable-fieldset")&&"fieldset"==t(a.item).attr("data-field")?a.helper.remove():t.ajax({type:"POST",dataType:"json",url:ft.ajax_url,data:{action:"ft_create_field",field_type:s},success:function(e){t(e.data.html).insertBefore(a.helper),t("#"+e.data.id).closest(".ft-field").find(".ft-edit").trigger("click"),"fieldset"==s&&t("#"+e.data.id).closest(".ft-field").find(".ft-sortable").sortable({placeholder:"ft-placeholder",forcePlaceholderSize:!0,connectWith:".ft-sortable"}),a.helper.remove()}})}})),t(document).on("sortreceive, sortupdate",".ft-field-fieldset .ft-sortable",(function(e,a){var s=t(this).closest(".ft-field-fieldset");t(e.target).is(".ft-sortable-fieldset")&&t(a.item).is(".ft-field-fieldset")?a.sender.sortable("cancel"):o(s)})),t(".ft-create-field").draggable({connectToSortable:".ft-sortable",helper:"clone",appendTo:"body"}),t(document).on("click",'.ft-values[name="selection"]',(function(){var e=t(this);e.prop("checked");"true"==e.attr("data-prev")?(e.prop("checked",!1),t("#ft-manual").find('input[type="radio"]').attr("data-prev","false")):(t("#ft-manual").find('input[type="radio"]').attr("data-prev","false"),e.attr("data-prev","true"))})),t(document).on("click",".ft-trash",(function(){var e=t(this).closest(".ft-field"),a=e.closest(".ft-sortable");return e.fadeOut(300,(function(){(e.remove(),a.is(".ft-sortable-fieldset"))&&o(a.closest(".ft-field-fieldset"))})),!1})),t(document).on("click",".ft-edit",(function(){l();var s,i,n=t(this).closest(".ft-field"),r=n.attr("data-controls"),o=t("#ft-edit-field-form"),f=n.find(".ft-label").text();t("#ft-edit-field-form").find(".ft-field").hide().removeClass("ft-active"),r=r.split(",");for(var d=0;d<r.length;d++)t("#ft-"+r[d]+"-field").show().addClass("ft-active");if(a((e=n).find(".ft-data").val())){var c=[],p=[],u="",v=t("#ft-manual");i=JSON.parse(e.find(".ft-data").val());for(var m=0,h=0,b=0;b<i.length;b++)if("values"==i[b].name)c[m]=i[b].value,m++;else if("conditions"==i[b].name)p[h]=i[b].value,h++;else if("selection"==i[b].name)u=i[b].value;else{var _=o.find(":input[name="+i[b].name+"]");if(_.is("select"))_.val(i[b].value);else if(_.is("textarea"))_.val(i[b].value);else switch(_.attr("type")){case"checkbox":_.prop("checked",!0);break;case"text":case"number":case"hidden":_.val(i[b].value)}}c&&t.ajax({type:"POST",dataType:"json",url:ft.ajax_url,data:{action:"ft_create_value",values:c,conditions:p,selection:u},success:function(t){var e=t.data.html;v.append(e)}}),t(".ft-values-type").change()}return s="fr"==ft.lang_code?"Modifier":"Edit",tb_show(s+" &lt;"+f+"&gt;","#TB_inline?width=600&height=550&inlineId=ft-edit-field",null),t("#ft-label").focus().select(),!1})),t(document).on("change",".ft-values-type",(function(){var e=t(this).val();t("#ft-values-field").find(".ft-values-tab").hide(),t("#"+e).show()})),t(document).on("change",'.ft-values-field input[name="values"]',(function(){var e=t(this);e.closest(".ft-values-field").find('input[name="selection"]').val(e.val())})),t(document).on("click",".ft-copy",(function(){var s,i=t(this).closest(".ft-field");if(a((e=i).find(".ft-data").val())){s=e.find(".ft-data").val();var n=JSON.parse(s)[0].value;t.ajax({type:"POST",dataType:"json",url:ft.ajax_url,data:{action:"ft_create_field",field_data:s,field_type:n},success:function(a){(t(a.data.html).insertBefore(i),e.closest(".ft-sortable").is(".ft-sortable-fieldset"))&&o(e.closest(".ft-field-fieldset"))}})}return!1})),t(document).on("click",".ft-add-value",(function(){t.ajax({type:"POST",dataType:"json",url:ft.ajax_url,data:{action:"ft_create_value"},success:function(e){t("#ft-manual").append(e.data.html)}})})),t(document).on("click",".ft-substract-value",(function(){t(this).closest(".ft-values-field").fadeOut(300,(function(){t(this).remove()}))})),t("#ft-save").on("click",(function(){var a=t("#ft-edit-field-form"),s=a.find("#ft-label").val(),i=a.find("#ft-btn-label").val(),n=a.find("#ft-text").val(),r=a.find("#ft-placeholder").val(),f=a.find("#ft-message").val().replace(/\n/g,"<br \\>"),d=a.find("#ft-value").val(),c=a.find("#ft-valuenum").val(),p=a.find("#ft-colsize").val(),u=a.find("#ft-required"),v=a.find("#ft-repeat"),m=JSON.stringify(t("#ft-edit-field-form .ft-active :input").filter((function(){return this.value||"conditions"==t(this).attr("name")||"selection"==t(this).attr("name")&&t(this).prop("checked")})).serializeArray()),h=t("#ft-edit-field-form .ft-values").filter((function(){return this.value})).serializeArray();e.removeClass((function(t,e){return(e.match(/(^|\s)ft-col-\S+/g)||[]).join(" ")})).addClass("ft-col-"+p);var b=e.find(".ft-display"),_=e.attr("data-type");if(e.find("> label .ft-label").text(s),""===i?e.find("button").text(e.find("button").attr("data-label")):e.find("button").text(i),e.find(".ft-text").text(n),u.prop("checked")?e.addClass("required").find("> label .ft-required").text("*"):e.removeClass("required").find("> label .ft-required").text(""),v.prop("checked")?e.find(".ft-repeat").show():e.find(".ft-repeat").hide(),b.is("select")?b.find("option").text(r):b.is("div")?b.html(f):""!==c?b.attr("placeholder",r).val(c):b.attr("placeholder",r).val(d),"checkbox"==_||"radio"==_){e.find(".ft-choice").empty();for(var x=0;x<h.length;x++)if("values"==h[x].name){var g=h[x].value.split(":"),y="";y=void 0!==g[1]?g[1]:g[0],e.find(".ft-choice").append('<label><input type="'+_+'" class="ft-display" value="">'+y+"</label>")}}(m=m.replace(/\\r\\n/g,"<br />"),e.find("> .ft-data").val(m),tb_remove(),e.closest(".ft-sortable").is(".ft-sortable-fieldset"))&&o(e.closest(".ft-field-fieldset"));return l(),!1})),t("#ft-cancel").on("click",(function(){return tb_remove(),!1})),t(document).on("click",".ft-autoselect",(function(){t(this).select()})),t("#custom_color").wpColorPicker(),t(".ft-select-tab").on("change",(function(){var e=t(this).val();t(this).closest(".ft-tab-content").find("[data-tab]").addClass("ft-hidden").end().find("[data-tab="+e+"]").removeClass("ft-hidden")})),t(".ft-upload-media").on("click",(function(){var e=wp.media.editor.send.attachment,a=t(this);return wp.media.editor.send.attachment=function(s,i){t(a).parent().prev().attr("src",i.url),t(a).prev().val(i.id),wp.media.editor.send.attachment=e},wp.media.editor.open(a),!1})),t(".ft-remove-media").on("click",(function(){var e=t(this).parent().prev().attr("data-src");return t(this).parent().prev().attr("src",e),t(this).prev().prev().val(""),!1})),t("#ft_response_form").on("change",(function(){var e=t(this);""==e.val()?t("#ft-export-response").attr("href","#").attr("disabled",!0):t("#ft-export-response").attr("href","admin.php?action=export_responses&form="+e.val()).attr("disabled",!1)}))}()})),t(window).on("load",(function(){""==t("#ft_response_form").val()?t("#ft-export-response").attr("href","#").attr("disabled",!0):t("#ft-export-response").attr("href","admin.php?action=export_responses&form="+t("#ft_response_form").val()).attr("disabled",!1)}))}(jQuery);