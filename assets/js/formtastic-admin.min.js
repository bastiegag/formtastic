!function(n){n(".ft-export").on("click",function(){var a=n(this),t=n("#export_form").val(),e=n("#export_from_date").val(),i=n("#export_to_date").val();return a.is(".ft-loading")||(a.addClass("ft-loading").prop("disabled",!0),n.ajax({type:"POST",dataType:"json",url:ft.ajax_url,data:{action:"ft_export_responses",form_id:t,min:e,max:i},success:function(t){var e=t.data.url;window.location.href=e,a.removeClass("ft-loading").prop("disabled",!1)}})),!1})}(jQuery),function(i){i(".ft-resend").on("click",function(){var e=i(this),t=e.attr("data-form"),a=e.attr("data-id");return e.is(".is-process")||(e.addClass("is-process").closest("tr").addClass("ft-sending"),i.ajax({type:"POST",dataType:"json",url:ft.ajax_url,data:{action:"ft_resend",form_id:t,response_id:a},success:function(t){e.removeClass("is-process").closest("tr").removeClass("ft-sending").addClass("ft-sended"),setTimeout(function(){e.closest("tr").removeClass("ft-sended")},1500)}})),!1})}(jQuery),function(n){jQuery.fn.formtasticTabs=function(){if("string"==typeof arguments[0]){var t=Array.prototype.slice.call(arguments);t.splice(0,1),methods[arguments[0]].apply(this,t)}else(function(t){this.each(function(){var i=n(this);i.find(".ft-tabs-nav a").each(function(){var t=n(this);if(t.is(".active")){var e=t.attr("href");i.find(e).addClass("active")}}).on("click",function(){var t=n(this),e=t.attr("href"),a=i.find(".ft-tabs-nav");return t.is(".active")||(a.find(".active").removeClass("active"),t.addClass("active"),i.find(".ft-tab-content.active").removeClass("active").end().find(e).addClass("active")),!1})})}).apply(this,arguments);return this}}(jQuery),function(e){e(".ft-unread").on("click",function(){var a=e(this),t=a.attr("data-id");return a.is(".is-process")||(a.addClass("is-process"),e.ajax({type:"POST",dataType:"json",url:ft.ajax_url,data:{action:"ft_read",response_id:t},success:function(t){var e=a.find("svg").attr("data-path");a.removeClass("ft-unread").addClass("ft-read"),a.find("svg use").attr("xlink:href",e+"#mail-open")}})),!1})}(jQuery),function(k){"use strict";k(window).on("load",function(){!function(){var y;function h(t){try{JSON.parse(t)}catch(t){return!1}return!0}var t=k("#export_from_date").datepicker({dateFormat:"d-m-yy",maxDate:0}).on("change",function(){e.datepicker("option","minDate",a(this))}),e=k("#export_to_date").datepicker({dateFormat:"d-m-yy",maxDate:0}).on("change",function(){t.datepicker("option","maxDate",a(this))});function a(t){var e;try{e=k.datepicker.parseDate("dd-mm-yy",t.value)}catch(t){e=null}return e}function x(t){if(h(t.find("> .ft-data").val())){for(var e=JSON.parse(t.find("> .ft-data").val()),a="",i=0;i<e.length;i++)if("fields"==e[i].name){e.splice(i,1);break}var n=0;t.find(".ft-sortable .ft-data").each(function(){var t=k(this).attr("id");a+=0===n?t:","+t,n++}),""!==a&&e.push({name:"fields",value:a}),t.find("> .ft-data").val(JSON.stringify(e))}}function _(){var t=k("#ft-edit-field-form :input"),e=k("#ft-edit-field-form .ft-values-field");t.each(function(){switch(k(this).attr("type")){case"text":k(this).val("");break;case"checkbox":k(this).prop("checked",!1)}}),e.each(function(){k(this).is(".ft-main")||k(this).remove()})}k(".ft-tabs").formtasticTabs(),k(".ft-sortable").disableSelection(),k(".ft-sortable").sortable({placeholder:"ft-placeholder",forcePlaceholderSize:!0,connectWith:".ft-sortable",tolerance:"pointer",start:function(t,e){if(!e.helper.is(".ft-create-field")){var a=e.helper.width(),i=e.helper.height();e.placeholder.width(a),e.placeholder.height(i-1)}}}),k(".ft-sortable-values").disableSelection(),k(".ft-sortable-values").sortable({placeholder:"ft-placeholder",forcePlaceholderSize:!0}),k(".ft-sortable").on("sortreceive",function(t,e){if(null!==e.helper&&e.item.is(".ft-create-field")){var a=e.helper.attr("data-field");e.helper.css("opacity","0"),k(t.target).is(".ft-sortable-fieldset")&&"fieldset"==k(e.item).attr("data-field")?e.helper.remove():k.ajax({type:"POST",dataType:"json",url:ft.ajax_url,data:{action:"ft_create_field",field_type:a},success:function(t){k(t.data.html).insertBefore(e.helper),k("#"+t.data.id).closest(".ft-field").find(".ft-edit").trigger("click"),"fieldset"==a&&k("#"+t.data.id).closest(".ft-field").find(".ft-sortable").sortable({placeholder:"ft-placeholder",forcePlaceholderSize:!0,connectWith:".ft-sortable"}),e.helper.remove()}})}}),k(document).on("sortreceive, sortupdate",".ft-field-fieldset .ft-sortable",function(t,e){var a=k(this).closest(".ft-field-fieldset");k(t.target).is(".ft-sortable-fieldset")&&k(e.item).is(".ft-field-fieldset")?e.sender.sortable("cancel"):x(a)}),k(".ft-create-field").draggable({connectToSortable:".ft-sortable",helper:"clone",appendTo:"body"}),k(document).on("click",'.ft-values[name="selection"]',function(){var t=k(this);t.prop("checked");"true"==t.attr("data-prev")?(t.prop("checked",!1),k("#ft-manual").find('input[type="radio"]').attr("data-prev","false")):(k("#ft-manual").find('input[type="radio"]').attr("data-prev","false"),t.attr("data-prev","true"))}),k(document).on("click",".ft-trash",function(){var t=k(this).closest(".ft-field"),e=t.closest(".ft-sortable");return t.fadeOut(300,function(){t.remove(),e.is(".ft-sortable-fieldset")&&x(e.closest(".ft-field-fieldset"))}),!1}),k(document).on("click",".ft-edit",function(){_();var t,e,a=k(this).closest(".ft-field"),i=a.attr("data-controls"),n=k("#ft-edit-field-form"),l=a.find(".ft-label").text();k("#ft-edit-field-form").find(".ft-field").hide().removeClass("ft-active"),i=i.split(",");for(var r=0;r<i.length;r++)k("#ft-"+i[r]+"-field").show().addClass("ft-active");if(h((y=a).find(".ft-data").val())){var f=[],s=[],d="",o=k("#ft-manual");e=JSON.parse(y.find(".ft-data").val());for(var c=0,u=0,v=0;v<e.length;v++)if("values"==e[v].name)f[c]=e[v].value,c++;else if("conditions"==e[v].name)s[u]=e[v].value,u++;else if("selection"==e[v].name)d=e[v].value;else{var p=n.find(":input[name="+e[v].name+"]");if(p.is("select"))p.val(e[v].value);else if(p.is("textarea"))p.text(e[v].value);else switch(p.attr("type")){case"checkbox":p.prop("checked",!0);break;case"text":case"number":case"hidden":p.val(e[v].value)}}f&&k.ajax({type:"POST",dataType:"json",url:ft.ajax_url,data:{action:"ft_create_value",values:f,conditions:s,selection:d},success:function(t){var e=t.data.html;o.append(e)}}),k(".ft-values-type").change()}return t="fr"==ft.lang_code?"Modifier":"Edit",tb_show(t+" &lt;"+l+"&gt;","#TB_inline?width=600&height=550&inlineId=ft-edit-field",null),k("#ft-label").focus().select(),!1}),k(document).on("change",".ft-values-type",function(){var t=k(this).val();k("#ft-values-field").find(".ft-values-tab").hide(),k("#"+t).show()}),k(document).on("change",'.ft-values-field input[name="values"]',function(){var t=k(this);t.closest(".ft-values-field").find('input[name="selection"]').val(t.val())}),k(document).on("click",".ft-copy",function(){var t,e=k(this).closest(".ft-field");if(h((y=e).find(".ft-data").val())){t=y.find(".ft-data").val();var a=JSON.parse(t)[0].value;k.ajax({type:"POST",dataType:"json",url:ft.ajax_url,data:{action:"ft_create_field",field_data:t,field_type:a},success:function(t){k(t.data.html).insertBefore(e),y.closest(".ft-sortable").is(".ft-sortable-fieldset")&&x(y.closest(".ft-field-fieldset"))}})}return!1}),k(document).on("click",".ft-add-value",function(){k.ajax({type:"POST",dataType:"json",url:ft.ajax_url,data:{action:"ft_create_value"},success:function(t){k("#ft-manual").append(t.data.html)}})}),k(document).on("click",".ft-substract-value",function(){k(this).closest(".ft-values-field").fadeOut(300,function(){k(this).remove()})}),k("#ft-save").on("click",function(){var t=k("#ft-edit-field-form"),e=t.find("#ft-label").val(),a=t.find("#ft-btn-label").val(),i=t.find("#ft-text").val(),n=t.find("#ft-placeholder").val(),l=t.find("#ft-message").val().replace(/\n/g,"<br \\>"),r=t.find("#ft-value").val(),f=t.find("#ft-valuenum").val(),s=t.find("#ft-colsize").val(),d=t.find("#ft-required"),o=t.find("#ft-repeat"),c=JSON.stringify(k("#ft-edit-field-form .ft-active :input").filter(function(){return this.value||"conditions"==k(this).attr("name")||"selection"==k(this).attr("name")&&k(this).prop("checked")}).serializeArray()),u=k("#ft-edit-field-form .ft-values").filter(function(){return this.value}).serializeArray();y.removeClass(function(t,e){return(e.match(/(^|\s)ft-col-\S+/g)||[]).join(" ")}).addClass("ft-col-"+s);var v=y.find(".ft-display"),p=y.attr("data-type");if(y.find("> label .ft-label").text(e),""===a?y.find("button").text(y.find("button").attr("data-label")):y.find("button").text(a),y.find(".ft-text").text(i),d.prop("checked")?y.addClass("required").find("> label .ft-required").text("*"):y.removeClass("required").find("> label .ft-required").text(""),o.prop("checked")?y.find(".ft-repeat").show():y.find(".ft-repeat").hide(),v.is("select")?v.find("option").text(n):v.is("div")?v.html(l):""!==f?v.attr("placeholder",n).val(f):v.attr("placeholder",n).val(r),"checkbox"==p||"radio"==p){y.find(".ft-choice").empty();for(var h=0;h<u.length;h++)if("values"==u[h].name){var m=u[h].value.split(":"),b="";b=void 0!==m[1]?m[1]:m[0],y.find(".ft-choice").append('<label><input type="'+p+'" class="ft-display" value="">'+b+"</label>")}}c=c.replace(/\\r\\n/g,"<br />"),y.find("> .ft-data").val(c),tb_remove(),y.closest(".ft-sortable").is(".ft-sortable-fieldset")&&x(y.closest(".ft-field-fieldset"));return _(),!1}),k("#ft-cancel").on("click",function(){return tb_remove(),!1}),k(document).on("click",".ft-autoselect",function(){k(this).select()}),k("#custom_color").wpColorPicker(),k(".ft-select-tab").on("change",function(){var t=k(this).val();k(this).closest(".ft-tab-content").find("[data-tab]").addClass("ft-hidden").end().find("[data-tab="+t+"]").removeClass("ft-hidden")}),k(".ft-upload-media").on("click",function(){var a=wp.media.editor.send.attachment,i=k(this);return wp.media.editor.send.attachment=function(t,e){k(i).parent().prev().attr("src",e.url),k(i).prev().val(e.id),wp.media.editor.send.attachment=a},wp.media.editor.open(i),!1}),k(".ft-remove-media").on("click",function(){var t=k(this).parent().prev().attr("data-src");return k(this).parent().prev().attr("src",t),k(this).prev().prev().val(""),!1})}()})}(jQuery);